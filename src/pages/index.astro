---
import BaseLayout from "../layouts/BaseLayout.astro";
import Comment from "../components/Comment.astro";
import { getAllComments } from "../comments";

const comments = getAllComments();
---

<BaseLayout>
  <h1 class="text-2xl">Comments</h1>
  <form
  hx-post="/api/comments/submit"
  hx-target="#comments"
  hx-swap="beforeend"
  hx-on::after-request="document.querySelector('#comment').value = ''"
  class="md:sticky top-0 z-10 bg-gray-400 p-2"
  >
  <div class="grid md:grid-cols-7">
    <label for="author" class="grow-0">Your name:</label>
    <input class="border col-span-6 p-1" type="text" name="author" id="author" required />
    <label for="comment" class="grow-0">Comment:</label>
    <input class="border col-span-6 p-1" type="text" name="comment" id="comment" required />
  </div>
  <button class="rounded-lg border-2 bg-blue-400 p-3 pt-2 hover:bg-blue-200">
    Submit</button
    >
  </form>
  <div id="comments">
    {comments.map((comment) => <Comment comment={comment} />)}
  </div>
</BaseLayout>
